---
title: "CSC 8631 - Future Learn Cuber Security Data Analysis Report"
author: "200709330 Hammad Mir"
date: "10/12/2021"
output:
  pdf_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath('..'))
```

```{r ProjectTemplate, include=FALSE}
library(ProjectTemplate)
load.project()
```


## Abstract

This article analyses the learner data for Cyber Security massive open online certificate (MOOC) by Newcastle University. It also demonstrates the advantages of repeatable data research with r markdown. The data collection comprises 62.csv files, from which enrollment data has been utilized for analysis with target demographic understanding as the overall objective. The study done is a freehand investigation of the data set, with the freedom to construct and answer our own questions.

## Introduction

A massive open online course (MOOC) is a type of online course that allows for limitless participation and unrestricted access over the Internet. Many MOOCs offer interactive courses with user forums or social media discussions to support community interactions among students, professors, and teaching assistants (TAs). They also immediate feedback to quick quizzes and assignments, in addition to traditional course materials such as filmed lectures, readings, and problem sets. MOOCs are a well-studied trend in online education that was initially launched in 2008 and became a popular way of learning in 2012. With MOOCs becoming more and more popular, a huge amount of data is generated by the users/learners which can be leveraged to optimize the course to meet the business requirements.


## Objective

The main objective of this analysis is to understand the target demographic. Our aim is to develop insights of the learners enrolled in the course. This analysis will helpful in developing the course to have a wider reach and be more appealing to the learners. We analyse the user information such as location data, gender, age, education, etc. to generate these insights. This gives us a better understanding of "Who" the learners are so that the course can be developed to the business needs and market demand. 

## Methodology

We followed the Cross-industry standard process for data mining (CRISP-DM) methodology for our analysis. CRISP-DM is an open standard process model that describes common approaches for data mining and analysis and is the most widely-used analytics model. CRISP-DM breaks the process of data mining into six major phases:

- Business Understanding
- Data Understanding
- Data Preparation
- Modelling
- Evaluation
- Deployment


The stage order is not strict, and travelling back and forth between stages is always needed. The process diagram's arrows represent the most essential and common relationships between phases. The diagram's outer circle represents the cyclical nature of data mining. After a solution has been installed, the data mining process continues. Lessons learnt during the process might prompt new, more focused business inquiries, and succeeding data mining operations will profit from prior ones' experiences. 

![CRISPDM_Process_Diagram](../images/CRISPDM_Process_Diagram.png)

## Dataset

The dataset for Cyber Security: Safety at Home, Online, in Life course includes 62 with files containing user data such as follows:
- Archetype survey
- Enrolments
- Leaving survey response
- Question response
- Step activity
- Team members
- Video stats
- Weekly sentiment survey responses

The dataset comprises data gathered from seven runs of the course. During our analysis, we concentrated solely on the enrolment data, which contains information about each learner such as gender, age, education, nation, and so on.

## Data Processing

We pre-processed the enrolment data to ensure that the country data for each user is retained either from the "detected country" or from "country" (set by learner), with priority being given to "country" field. The file contained many missing values, so the data was filtered during analysis, dropping rows where gender, age, highest education and employment status were missing.

### Assumption

- Since the bulk of the fields are "unknown", all of the analyses is performed by deleting the rows with "unknown" values. As a result, we are assuming this subset represents the genuine population distribution.
- We are assuming "detected country" is a good enough measure for the location of the learner as most of the values in the "country" field are "Unknown".

## Analysis

Following the CRISP-DM model, we performed our analysis in more than one cycle as explained below, with our main business objective being target demographic understanding:

### Cycle 1: Where learners are from.

We analysed the country the learners are from and generated a map plot with heatmap describing the number of users per country as shown below. As can be seen from the generated map, most of the users are from the UK, followed by India and US. Observing the map over 7 runs of the course, we find the similar findings/distribution as stated above.

```{r, echo=FALSE}
create_map(cyber.security.1_enrolments) +
  labs(title = "Figure 1: Country-wise users") +
  theme(plot.title = element_text(hjust = 0.5))
```

### Cycle 2: Enrolments over 7 runs.

To understand how the course has been performing over the 7 iterations, we analysed the data and generated a plot showing enrolments over the 7 runs. From the figure we clearly observe that the enrolment over 7 runs has been decreasing.

```{r, echo=FALSE}
# loop to retrieve only enrollments data over all the runs
iter <- c()
users <- c()
for(i in project.info$cache){
  if(grepl("enrolments", i, fixed = TRUE)){
    #print(i)
    iter <- append(iter, paste("run", gsub(".*?([0-9]+).*", "\\1", i), sep = "_"))
    users <- append(users, nrow(get(i)))
  }
}

users_per_iter <- data.frame(iter, users)

#plot to see differences in enrollments over runs
ggplot(data=users_per_iter, aes(x=iter, y=users, group=1)) +
  geom_line(color="red", size = 1.3)+
  xlab("Iterations") +
  geom_point(size = 2) +
  labs(title = "Figure 2: Users over 7 iterations") +
  theme(plot.title = element_text(hjust = 0.5))
```

### Cycle 3: Who the learners are.

Following the location and enrolment analysis, we decided to analyse the learner data further to understand who they are. The inference from these features is as follows:

```{r, include=FALSE}

# generating empty data frames for comparison over 7 runs of the course

all_run_gender <- data.frame(matrix(ncol = 3, nrow = 0))
colnames(all_run_gender) <- c("gender", "users", "run")

all_run_age <- data.frame(matrix(ncol = 3, nrow = 0))
colnames(all_run_age) <- c("age_range", "users", "run")

all_run_edu <- data.frame(matrix(ncol = 3, nrow = 0))
colnames(all_run_edu) <- c("edu_level", "users", "run")

all_run_emp_status <- data.frame(matrix(ncol = 3, nrow = 0))
colnames(all_run_emp_status) <- c("emp_status", "users", "run")

all_run_emp_area <- data.frame(matrix(ncol = 3, nrow = 0))
colnames(all_run_emp_area) <- c("emp_area", "users", "run")

for(i in project.info$cache){
  if(grepl("enrolments", i, fixed = TRUE)){
    
    iter = gsub(".*?([0-9]+).*", "\\1", i)
    
    subset_data = filter(get(i), !(gender == "Unknown" | age_range == "Unknown" |
                                                          highest_education_level == "Unknown" |
                                                          employment_status == "Unknown"))
    
    gender <- data.frame(table(subset_data$gender))
    colnames(gender) <- c("gender", "users")
    #gender$gender <- as.logical(gender$gender)
    gender$run <- rep(iter, times = nrow(gender))
    #gender$run <- as.logical(gender$run)
    all_run_gender <- rbind(all_run_gender, gender)
    
    age <- data.frame(table(subset_data$age_range))
    colnames(age) <- c("age_range", "users")
    age$run <- rep(iter, times = nrow(age))
    all_run_age <- rbind(all_run_age, age)
    
    edu <- data.frame(table(subset_data$highest_education_level))
    colnames(edu) <- c("edu_level", "users")
    edu$run <- rep(iter, times = nrow(edu))
    all_run_edu <- rbind(all_run_edu, edu)
    
    emp_status <- data.frame(table(subset_data$employment_status))
    colnames(emp_status) <- c("emp_status", "users")
    emp_status$run <- rep(iter, times = nrow(emp_status))
    all_run_emp_status <- rbind(all_run_emp_status, emp_status)
    
    emp_area <- data.frame(table(subset_data$employment_area))
    colnames(emp_area) <- c("emp_area", "users")
    #emp_area <- filter(emp_area, !(emp_area == "Unknown"))
    emp_area$run <- rep(iter, times = nrow(emp_area))
    all_run_emp_area <- rbind(all_run_emp_area, emp_area)
  }
}

# creating comparison plots for each of the features over 7 runs
all_gender_plot <- ggplot(data=all_run_gender, aes(x=gender, y=users, fill = run)) +
  geom_bar(stat="identity", position=position_dodge()) +
  labs(title = "Figure 3: Gender Distribution Plot") +
  theme(plot.title = element_text(hjust = 0.5))
#all_gender_plot                 #plot check

all_age_plot <- ggplot(data=all_run_age, aes(x=age_range, y=users, fill = run)) +
  geom_bar(stat="identity", position=position_dodge()) +
  labs(title = "Figure 3: Age Distribution Plot") +
  theme(plot.title = element_text(hjust = 0.5))
#all_age_plot                 #plot check

all_edu_plot <- ggplot(data=all_run_edu, aes(x=edu_level, y=users, fill = run)) +
  geom_bar(stat="identity", position=position_dodge()) +
  theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
  labs(title = "Figure 4: Education Distribution Plot") +
  theme(plot.title = element_text(hjust = 0.5))
#all_edu_plot                 #plot check

all_emp_sta_plot <- ggplot(data=all_run_emp_status, aes(x=emp_status, y=users, fill = run)) +
  geom_bar(stat="identity", position=position_dodge()) +
  theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
  labs(title = "Figure 5: Employmet Status Plot") +
  theme(plot.title = element_text(hjust = 0.5))
#all_emp_sta_plot                 #plot check

all_run_emp_area <- filter(all_run_emp_area, !(emp_area == "Unknown"))
all_emp_area_plot <- ggplot(data=all_run_emp_area, aes(x=emp_area, y=users, fill = run)) +
  geom_bar(stat="identity", position=position_dodge()) +
  theme(axis.text.x = element_text(angle = 25, hjust = 1)) +
  labs(title = "Figure 6: Employment Area Plot") +
  theme(plot.title = element_text(hjust = 0.5))
#all_emp_area_plot

#creating layout matrix for final plot
lay <- rbind(c(1, 2),
             c(3, 4),
             c(5, 5),
             c(5, 5))

# Generating a combined plot
#grid.arrange(all_gender_plot, all_age_plot, all_edu_plot, all_emp_sta_plot, all_emp_area_plot, layout_matrix = lay)
```

#### Learner Gender Distribution

From the gender distribution plot of the learners below, we clearly observe that the number of learners that are males is the highest, followed closely by female learners. Those identifying as non-binary and other are just a few. We observe that overall throughout the 7 runs of the course, the gender distribution trend remains almost the same.

```{r, echo=FALSE}
#all_gender_plot
```

#### Learners age distribution

The age distribution plot of the learners shows the maximum number of learners belong to 26 to 35 years age group and the least number of learners are under the age of 18. Overall we observe the same trend through the 7 iterations of the course.

```{r, echo=FALSE}
grid.arrange(all_gender_plot, all_age_plot, nrow = 2)
#all_gender_plot
#all_age_plot
```

#### Learners highest education

The education distribution plot shows clearly that the number of learners with a university degree is the highest followed by those with a masters degree. We also observe the least number of learners have less than secondary, university doctorate and apprenticeship level educational background. In general we observe the same trend all through the 7 runs of the course.

```{r, echo=FALSE}
#all_edu_plot
```

#### Learners employment status

The employment status plot shows that the number of learners with a full time job is the highest, with un employed and non working learners being the lowest in number. As we have been observing so fat, the same trend can be observed for all of the 7 runs of the course.

```{r, echo=FALSE}
grid.arrange(all_edu_plot, all_emp_sta_plot, nrow = 2)
#all_edu_plot
#all_emp_sta_plot
```

#### Learners employment area

The employment area plot below suggests that the highest number of learners belong to the it sector followed closely by those in the teaching and education sector. We observe a similar trend over 7 runs of the course.

```{r, echo=FALSE}
all_emp_area_plot
```

## Conclusion

The analysis suggests that for targeting right audience we can say that people from all age range, in IT and Education sector, and working full time are interested so, ads can be optimized by keeping these criteria into
consideration.